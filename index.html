<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>RPG Stat Calculator</title>
  <!-- Include Chart.js for the graphs -->
  <link rel="stylesheet" href="css/entity-manager.css">
  <link rel="stylesheet" href="css/stat-calculator.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h2>Action-RPG Stat Calculator</h2>
  <p>User: baskax | Last Updated: 2025-05-06 09:46:08 UTC</p>

<section id="entity-manager">
  <h3>Entity Management</h3>
  <div class="entity-form">
    <input type="hidden" id="entityId">
    
    <div class="form-group">
      <label for="entityName">Name:</label>
      <input type="text" id="entityName" placeholder="Character Name">
    </div>
    
    <div class="form-group">
      <label for="entityType">Type:</label>
      <select id="entityType">
        <option value="player">Player</option>
        <option value="enemy">Enemy</option>
        <option value="npc">NPC</option>
      </select>
    </div>
    
    <div class="form-group entity-actions">
      <button id="saveEntityBtn">Save Entity</button>
      <button id="newEntityBtn">New Entity</button>
      <button id="deleteEntityBtn">Delete Entity</button>
    </div>
  </div>
  
  <div class="saved-entities">
    <h4>Saved Entities</h4>
    <select id="entityList" size="5">
      <option value="" disabled>No entities saved yet</option>
    </select>
  </div>
</section>
  
  <section>
    <h3>1) Primary Attributes</h3>
    <label class="stat-label">
      POW <input type="number" id="pow" value="50" min="0"/>
      <div class="tooltip">
        <h4>Power</h4>
        <p>Base physical strength – directly feeds your basic melee damage.</p>
      </div>
    </label>
    <label class="stat-label">
      DEX <input type="number" id="dex" value="50" min="0"/>
      <div class="tooltip">
        <h4>Dexterity</h4>
        <p>Agility and precision – ups your attack-speed, evasion, and crit.</p>
      </div>
    </label>
    <label class="stat-label">
      VIT <input type="number" id="vit" value="50" min="0"/>
      <div class="tooltip">
        <h4>Vitality</h4>
        <p>Raw sturdiness – determines your health pool (HP) and stamina (STA).</p>
      </div>
    </label>
    <label class="stat-label">
      FOC <input type="number" id="foc" value="50" min="0"/>
      <div class="tooltip">
        <h4>Focus</h4>
        <p>Mental acuity – boosts skill damage, critical chance, and cooldown reduction.</p>
      </div>
    </label>
    <label class="stat-label">
      SPR <input type="number" id="spr" value="50" min="0"/>
      <div class="tooltip">
        <h4>Spirit</h4>
        <p>Inner energy – fuels your energy/mana pool (ENG) and resistances.</p>
      </div>
    </label>
  </section>

  <section>
    <h3>2) Config (live-edit weights & exponents)</h3>
    <table id="configTable">
      <thead>
        <tr>
          <th>Stat</th>
          <th>w1</th>
          <th>w2</th>
          <th>pre</th>
          <th>exp</th>
          <th>mult</th>
          <th>post</th>
          <th style="width:25%">Formula & Graph</th>
        </tr>
      </thead>
      <tbody>
        <tr data-stat="HP">
          <td class="stat-label">
            HP
            <div class="tooltip">
              <h4>Health Points</h4>
              <p>How much damage you can take before dying.</p>
            </div>
          </td>
          <td><input type="number" step="any" id="HP_w1" value="1"/></td>
          <td><input type="number" step="any" id="HP_w2" value="0.5"/></td>
          <td><input type="number" step="any" id="HP_pre" value="0"/></td>
          <td><input type="number" step="any" id="HP_exp" value="1.25"/></td>
          <td><input type="number" step="any" id="HP_mult" value="5"/></td>
          <td><input type="number" step="any" id="HP_post" value="0"/></td>
          <td>
            <div class="stat-row">
              <div class="formula" id="HP_formula"></div>
              <div class="graph-container" data-stat="HP"><canvas id="HP_graph"></canvas></div>
              <button class="graph-toggle" data-stat="HP">Toggle Primary Stat</button>
            </div>
          </td>
        </tr>
        <tr data-stat="STA">
          <td class="stat-label">
            STA
            <div class="tooltip">
              <h4>Stamina</h4>
              <p>Resource for dodges/sprints—how often you can evade or sprint.</p>
            </div>
          </td>
          <td><input type="number" step="any" id="STA_w1" value="1"/></td>
          <td><input type="number" step="any" id="STA_w2" value="0.5"/></td>
          <td><input type="number" step="any" id="STA_pre" value="0"/></td>
          <td><input type="number" step="any" id="STA_exp" value="1.15"/></td>
          <td><input type="number" step="any" id="STA_mult" value="4"/></td>
          <td><input type="number" step="any" id="STA_post" value="0"/></td>
          <td>
            <div class="stat-row">
              <div class="formula" id="STA_formula"></div>
              <div class="graph-container" data-stat="STA"><canvas id="STA_graph"></canvas></div>
              <button class="graph-toggle" data-stat="STA">Toggle Primary Stat</button>
            </div>
          </td>
        </tr>
        <tr data-stat="ENG">
          <td class="stat-label">
            ENG
            <div class="tooltip">
              <h4>Energy</h4>
              <p>Pool for skills/spells—how many abilities you can cast.</p>
            </div>
          </td>
          <td><input type="number" step="any" id="ENG_w1" value="1"/></td>
          <td><input type="number" step="any" id="ENG_w2" value="0.5"/></td>
          <td><input type="number" step="any" id="ENG_pre" value="0"/></td>
          <td><input type="number" step="any" id="ENG_exp" value="1.2"/></td>
          <td><input type="number" step="any" id="ENG_mult" value="4"/></td>
          <td><input type="number" step="any" id="ENG_post" value="0"/></td>
          <td>
            <div class="stat-row">
              <div class="formula" id="ENG_formula"></div>
              <div class="graph-container" data-stat="ENG"><canvas id="ENG_graph"></canvas></div>
              <button class="graph-toggle" data-stat="ENG">Toggle Primary Stat</button>
            </div>
          </td>
        </tr>
        <tr data-stat="PDMG">
          <td class="stat-label">
            PDMG
            <div class="tooltip">
              <h4>Physical Damage</h4>
              <p>Damage dealt by your standard melee or ranged attacks.</p>
            </div>
          </td>
          <td><input type="number" step="any" id="PDMG_w1" value="1"/></td>
          <td><input type="number" step="any" id="PDMG_w2" value="0.5"/></td>
          <td><input type="number" step="any" id="PDMG_pre" value="0"/></td>
          <td><input type="number" step="any" id="PDMG_exp" value="1.35"/></td>
          <td><input type="number" step="any" id="PDMG_mult" value="3"/></td>
          <td><input type="number" step="any" id="PDMG_post" value="0"/></td>
          <td>
            <div class="stat-row">
              <div class="formula" id="PDMG_formula"></div>
              <div class="graph-container" data-stat="PDMG"><canvas id="PDMG_graph"></canvas></div>
              <button class="graph-toggle" data-stat="PDMG">Toggle Primary Stat</button>
            </div>
          </td>
        </tr>
        <tr data-stat="SKDMG">
          <td class="stat-label">
            SKDMG
            <div class="tooltip">
              <h4>Skill Damage</h4>
              <p>Damage dealt by your special abilities or spells.</p>
            </div>
          </td>
          <td><input type="number" step="any" id="SKDMG_w1" value="1"/></td>
          <td><input type="number" step="any" id="SKDMG_w2" value="0.5"/></td>
          <td><input type="number" step="any" id="SKDMG_pre" value="0"/></td>
          <td><input type="number" step="any" id="SKDMG_exp" value="1.3"/></td>
          <td><input type="number" step="any" id="SKDMG_mult" value="3"/></td>
          <td><input type="number" step="any" id="SKDMG_post" value="0"/></td>
          <td>
            <div class="stat-row">
              <div class="formula" id="SKDMG_formula"></div>
              <div class="graph-container" data-stat="SKDMG"><canvas id="SKDMG_graph"></canvas></div>
              <button class="graph-toggle" data-stat="SKDMG">Toggle Primary Stat</button>
            </div>
          </td>
        </tr>
        <tr data-stat="ASPD">
          <td class="stat-label">
            ASPD
            <div class="tooltip">
              <h4>Attack Speed</h4>
              <p>Multiplier on your attack animation/swing speed (1.00 = baseline).</p>
            </div>
          </td>
          <td><input type="number" step="any" id="ASPD_w1" value="1"/></td>
          <td><input type="number" step="any" id="ASPD_w2" value="0"/></td>
          <td><input type="number" step="any" id="ASPD_pre" value="0"/></td>
          <td><input type="number" step="any" id="ASPD_exp" value="1"/></td>
          <td><input type="number" step="any" id="ASPD_mult" value="0.01"/></td>
          <td><input type="number" step="any" id="ASPD_post" value="1"/></td>
          <td>
            <div class="stat-row">
              <div class="formula" id="ASPD_formula"></div>
              <div class="graph-container" data-stat="ASPD"><canvas id="ASPD_graph"></canvas></div>
              <button class="graph-toggle" data-stat="ASPD">Toggle Primary Stat</button>
            </div>
          </td>
        </tr>
        <tr data-stat="CRIT">
          <td class="stat-label">
            CRIT%
            <div class="tooltip">
              <h4>Critical Chance %</h4>
              <p>Chance for any attack or skill to hit for bonus (critical) damage.</p>
            </div>
          </td>
          <td><input type="number" step="any" id="CRIT_w1" value="1"/></td>
          <td><input type="number" step="any" id="CRIT_w2" value="0.5"/></td>
          <td><input type="number" step="any" id="CRIT_pre" value="0"/></td>
          <td><input type="number" step="any" id="CRIT_exp" value="1.25"/></td>
          <td><input type="number" step="any" id="CRIT_mult" value="0.2"/></td>
          <td><input type="number" step="any" id="CRIT_post" value="0"/></td>
          <td>
            <div class="stat-row">
              <div class="formula" id="CRIT_formula"></div>
              <div class="graph-container" data-stat="CRIT"><canvas id="CRIT_graph"></canvas></div>
              <button class="graph-toggle" data-stat="CRIT">Toggle Primary Stat</button>
            </div>
          </td>
        </tr>
        <tr data-stat="ARM">
          <td class="stat-label">
            ARM
            <div class="tooltip">
              <h4>Armor</h4>
              <p>Flat physical damage mitigation.</p>
            </div>
          </td>
          <td><input type="number" step="any" id="ARM_w1" value="1"/></td>
          <td><input type="number" step="any" id="ARM_w2" value="0.5"/></td>
          <td><input type="number" step="any" id="ARM_pre" value="0"/></td>
          <td><input type="number" step="any" id="ARM_exp" value="1.1"/></td>
          <td><input type="number" step="any" id="ARM_mult" value="2"/></td>
          <td><input type="number" step="any" id="ARM_post" value="0"/></td>
          <td>
            <div class="stat-row">
              <div class="formula" id="ARM_formula"></div>
              <div class="graph-container" data-stat="ARM"><canvas id="ARM_graph"></canvas></div>
              <button class="graph-toggle" data-stat="ARM">Toggle Primary Stat</button>
            </div>
          </td>
        </tr>
        <tr data-stat="RES">
          <td class="stat-label">
            RES
            <div class="tooltip">
              <h4>Resistance</h4>
              <p>Flat elemental/status resistance (fire, poison, stun-chance, etc.).</p>
            </div>
          </td>
          <td><input type="number" step="any" id="RES_w1" value="1"/></td>
          <td><input type="number" step="any" id="RES_w2" value="0.25"/></td>
          <td><input type="number" step="any" id="RES_pre" value="0"/></td>
          <td><input type="number" step="any" id="RES_exp" value="1.1"/></td>
          <td><input type="number" step="any" id="RES_mult" value="2"/></td>
          <td><input type="number" step="any" id="RES_post" value="0"/></td>
          <td>
            <div class="stat-row">
              <div class="formula" id="RES_formula"></div>
              <div class="graph-container" data-stat="RES"><canvas id="RES_graph"></canvas></div>
              <button class="graph-toggle" data-stat="RES">Toggle Primary Stat</button>
            </div>
          </td>
        </tr>
        <tr data-stat="CDR">
          <td class="stat-label">
            CDR%
            <div class="tooltip">
              <h4>Cooldown Reduction</h4>
              <p>Percent reduction on all skill cooldown timers.</p>
            </div>
          </td>
          <td><input type="number" step="any" id="CDR_w1" value="1"/></td>
          <td><input type="number" step="any" id="CDR_w2" value="0.5"/></td>
          <td><input type="number" step="any" id="CDR_pre" value="0"/></td>
          <td><input type="number" step="any" id="CDR_exp" value="1.15"/></td>
          <td><input type="number" step="any" id="CDR_mult" value="0.1"/></td>
          <td><input type="number" step="any" id="CDR_post" value="0"/></td>
          <td>
            <div class="stat-row">
              <div class="formula" id="CDR_formula"></div>
              <div class="graph-container" data-stat="CDR"><canvas id="CDR_graph"></canvas></div>
              <button class="graph-toggle" data-stat="CDR">Toggle Primary Stat</button>
            </div>
          </td>
        </tr>
        <tr data-stat="MSPD">
          <td class="stat-label">
            MSPD%
            <div class="tooltip">
              <h4>Move Speed</h4>
              <p>Percent bonus (or penalty) to your base movement speed.</p>
            </div>
          </td>
          <td><input type="number" step="any" id="MSPD_w1" value="1"/></td>
          <td><input type="number" step="any" id="MSPD_w2" value="0.5"/></td>
          <td><input type="number" step="any" id="MSPD_pre" value="0"/></td>
          <td><input type="number" step="any" id="MSPD_exp" value="1.1"/></td>
          <td><input type="number" step="any" id="MSPD_mult" value="0.1"/></td>
          <td><input type="number" step="any" id="MSPD_post" value="0"/></td>
          <td>
            <div class="stat-row">
              <div class="formula" id="MSPD_formula"></div>
              <div class="graph-container" data-stat="MSPD"><canvas id="MSPD_graph"></canvas></div>
              <button class="graph-toggle" data-stat="MSPD">Toggle Primary Stat</button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </section>

  <section>
    <h3>3) Computed Secondaries</h3>
    <table>
      <thead>
        <tr>
          <th>Stat</th>
          <th>Value</th>
        </tr>
      </thead>
      <tbody id="secBody"></tbody>
    </table>
  </section>

  <!-- Modal for expanded graph -->
  <div id="graphModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title" id="modalTitle">Graph</h3>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="expanded-graph-container">
          <canvas id="expandedGraph"></canvas>
        </div>
        <div class="controls" style="display: flex; justify-content: space-between; margin-top: 1rem;">
          <button id="expandedToggle" class="graph-toggle">Toggle Primary Stat</button>
          <div>
            <label for="rangeSlider">Range: </label>
            <input type="range" id="rangeSlider" min="10" max="100" value="50" step="5">
            <span id="rangeValue">50</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="js/primary-attributes.js"></script>
  <script src="js/config-table.js"></script>
  <script src="js/computed-secondaries.js"></script>
  <script src="js/modal-tooltip.js"></script>
  <script src="js/event-listeners.js"></script>
  <script>
    setupEventListeners();
  </script>
  <!-- Include the database script -->
  <script src="js/db.js"></script>

  <!-- Include the entity manager script -->
  <script src="js/entity-manager.js"></script>

  <!-- This can be included in your existing HTML file -->
</body>
</html>
